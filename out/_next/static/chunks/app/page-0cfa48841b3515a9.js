(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{37:()=>{},385:()=>{},1065:()=>{},3337:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>u});var o=i(5155),a=i(4257),r=i(2115),l=i(438),n=i(3429),d=i.n(n),s=i(760),c=i(7869);let h=function(){let e=(0,r.useRef)(null),t=(0,r.useRef)(null),i=(0,r.useRef)(null),[n,h]=(0,r.useState)([]),[u,g]=(0,r.useState)({width:0,height:0}),[f,p]=(0,r.useState)([]),[x,b]=(0,r.useState)([]),[v,m]=(0,r.useState)(!1),[y,w]=(0,r.useState)(!1),[j,S]=(0,r.useState)(!1),[k,W]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{let e="/models/faceapi";try{await a.jh6("webgl"),await Promise.all([l.B0.tinyFaceDetector.loadFromUri(e),l.B0.faceLandmark68Net.loadFromUri(e),l.B0.ageGenderNet.loadFromUri(e)]),console.log("Face API models loaded");let t=await a.O0W("/models/clothing/model.json");i.current=t,console.log("TensorFlow model loaded",t),S(!0);let o=await fetch("/models/clothing/metadata.json"),r=await o.json();b(r.labels),console.log("Metadata loaded",r),m(!0)}catch(e){console.error("Error loading models:",e)}})()},[]);let F=(0,r.useCallback)(async()=>{if(i.current&&e.current&&y&&j)try{let t=e.current.video||e.current;if(!t||4!==t.readyState||0===t.videoWidth||0===t.videoHeight)return void console.log("Video element not fully ready for prediction");let o=a.TaL.fromPixels(t).resizeNearestNeighbor([224,224]).toFloat().div(a.d_2(255)).expandDims(),r=await i.current.predict(o).data(),l=[];if(r&&x.length>0)for(let e=0;e<x.length;e++){let i=r[e];if(i>.6){let o=Math.random()*(t.videoWidth-100),a=Math.random()*(t.videoHeight-100);l.push({bbox:[o/t.videoWidth,a/t.videoHeight,100/t.videoWidth,100/t.videoHeight],className:x[e],probability:i})}}let n=l.map(e=>({...e,scaledBBox:[e.bbox[0]*t.videoWidth,e.bbox[1]*t.videoHeight,e.bbox[2]*t.videoWidth,e.bbox[3]*t.videoHeight]}));W(n),void 0!==o&&a.ASo(o)}catch(e){console.error("Error during clothing prediction:",e)}},[i,e,y,j,x]),N=(0,r.useCallback)(()=>{let t=e.current.video||e.current;t&&(g({width:t.videoWidth,height:t.videoHeight}),w(!0))},[]);return(0,r.useEffect)(()=>{let t,i;return v&&e.current&&y&&j&&(t=setInterval(async()=>{let t=e.current.video||e.current;if(t&&4===t.readyState&&t.videoWidth>0&&t.videoHeight>0){let e={width:t.videoWidth,height:t.videoHeight},i=await l.R(t,new l.ex).withFaceLandmarks().withAgeAndGender();h(l.Lz(i,e))}},100),i=setInterval(F,200)),()=>{clearInterval(t),clearInterval(i)}},[v,e,y,F,j]),(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("h1",{children:"Face and Clothing Detection"}),(0,o.jsxs)("div",{ref:t,style:{position:"relative",display:"inline-block",width:"".concat(u.width,"px"),height:"".concat(u.height,"px")},children:[(0,o.jsx)(d(),{ref:e,width:"100%",height:"auto",onPlay:N,autoPlay:!0,muted:!0,style:{display:"block"}}),(0,o.jsxs)(s.N,{children:[n.map((e,t)=>{let{x:i,y:a,width:r,height:l}=e.detection.box,n=Math.round(e.age),d=e.gender,s=(100*e.genderProbability).toFixed(0);return(0,o.jsxs)(c.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1,left:i,top:a,width:r,height:l},exit:{opacity:0},transition:{duration:.1,ease:"easeInOut"},style:{position:"absolute",border:"2px solid #00ff88",borderRadius:"8px",zIndex:2,color:"#00ff88",fontWeight:"bold",fontSize:"12px",padding:"2px",backgroundColor:"rgba(0, 0, 0, 0.3)",pointerEvents:"none"},children:[n," yrs | ",d," (",s,"%)"]},"face-".concat(t))}),k.map((e,t)=>{let[i,a,r,l]=e.scaledBBox;return(0,o.jsxs)(c.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1,left:i,top:a,width:r,height:l},exit:{opacity:0},transition:{duration:.1,ease:"easeInOut"},style:{position:"absolute",border:"2px solid #ff0000",borderRadius:"8px",zIndex:2,color:"#ff0000",fontWeight:"bold",fontSize:"16px",padding:"8px",backgroundColor:"rgba(0, 0, 0, 0.5)",pointerEvents:"none",textAlign:"center"},children:[e.className,": ",(100*e.probability).toFixed(2),"%"]},"clothing-".concat(t))})]})]})]})};function u(){return(0,o.jsx)("div",{className:" flex flex-col items-center justify-center min-h-screen p-4 ",children:(0,o.jsx)(h,{})})}},3886:()=>{},4132:()=>{},4938:()=>{},5450:()=>{},5586:(e,t,i)=>{Promise.resolve().then(i.bind(i,3337))},9430:()=>{},9633:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[479,692,208,57,441,684,358],()=>t(5586)),_N_E=e.O()}]);